"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkDependencies = void 0;
const project_graph_1 = require("../../../core/project-graph");
/**
 * Check whether the project to be removed is depended on by another project
 *
 * Throws an error if the project is in use, unless the `--forceRemove` option is used.
 */
function checkDependencies(_, schema) {
    if (schema.forceRemove) {
        return;
    }
    const graph = project_graph_1.createProjectGraph(undefined, undefined, undefined);
    const reverseGraph = project_graph_1.onlyWorkspaceProjects(project_graph_1.reverse(graph));
    const deps = reverseGraph.dependencies[schema.projectName] || [];
    if (deps.length > 0) {
        throw new Error(`${schema.projectName} is still depended on by the following projects:\n${deps
            .map((x) => x.target)
            .join('\n')}`);
    }
}
exports.checkDependencies = checkDependencies;
//# sourceMappingURL=check-dependencies.js.map